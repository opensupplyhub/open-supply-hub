name: "DB - Apply Anonymized db"

on:
  push:
    branches:
      - OSDEV-862-create-script-for-anonymizing-dump
  workflow_dispatch:

jobs:
  save-anonymized-db:
    runs-on: ubuntu-latest
    environment: ${{ inputs.deploy-env || 'Test' }}
    
    steps:
      - name: Get Environment Name for ${{ vars.ENV_NAME }}
        id: get_env_name
        uses: Entepotenz/change-string-case-action-min-dependencies@v1
        with:
          string: ${{ vars.ENV_NAME }}
      - name: Checkout repo
        uses: actions/checkout@v4
      - name: Restore database for ${{ vars.ENV_NAME }}
        run: |
          ls -la
          cd ./src/anon-tools
          mkdir -p ./keys
          echo ${{ secrets.KEY_FILE }} >> ./keys/key
          ls -la ./keys